(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"8y03":function(e,t,r){"use strict";r.r(t),r.d(t,"CheckoutModule",(function(){return N}));var o=r("ofXK"),c=r("tyNb"),n=r("3Pt+"),s=r("fXoL"),i=r("2rwd"),b=r("B/XX");function a(e,t){if(1&e){const e=s.Rb();s.Qb(0,"li",4),s.Qb(1,"button",5),s.Xb("click",(function(){s.pc(e);const r=t.index;return s.Zb().onClick(r)})),s.yc(2),s.Pb(),s.Pb()}if(2&e){const e=t.$implicit,r=t.index,o=s.Zb();s.zb(1),s.Cb("active",o.selectedIndex===r),s.zb(1),s.Ac(" ",e.label," ")}}let l=(()=>{class e extends b.b{ngOnInit(){this.linear=this.linearModeSelected}onClick(e){this.selectedIndex=e}}return e.\u0275fac=function(t){return u(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["app-stepper"]],inputs:{linearModeSelected:"linearModeSelected"},features:[s.yb([{provide:b.b,useExisting:e}]),s.wb],decls:5,vars:2,consts:[[1,"container"],[1,"nav","nav-pills","nav-justified"],["class","nav-item",4,"ngFor","ngForOf"],[3,"ngTemplateOutlet"],[1,"nav-item"],[1,"nav-link","py-3","text-uppercase","font-weight-bold","btn-block",3,"click"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"ul",1),s.wc(2,a,3,3,"li",2),s.Pb(),s.Qb(3,"div"),s.Mb(4,3),s.Pb(),s.Pb()),2&e&&(s.zb(2),s.fc("ngForOf",t.steps),s.zb(2),s.fc("ngTemplateOutlet",t.selected.content))},directives:[o.l,o.o],styles:["button.nav-link[_ngcontent-%COMP%]{background:#e9ecef;border-radius:0;border:none}button.nav-link[_ngcontent-%COMP%]:focus{outline:none}button.nav-link.active[_ngcontent-%COMP%]:hover{color:#fff}button.nav-link.active[_ngcontent-%COMP%]:focus, button.nav-link[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:active{outline:none}"]}),e})();const u=s.Sb(l);var d=r("5eHb"),p=r("gA0Q");let f=(()=>{class e{constructor(e,t){this.accountService=e,this.toastr=t}ngOnInit(){}saveUserAddress(){this.accountService.updateUserAddress(this.checkoutForm.get("addressForm").value).subscribe(()=>{this.toastr.success("Address saved")},e=>{this.toastr.error(e.statusText),console.log(e)})}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(i.a),s.Kb(d.b))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-checkout-address"]],inputs:{checkoutForm:"checkoutForm"},decls:26,vars:8,consts:[[1,"mt-4",3,"formGroup"],[1,"d-flex","justify-content-between","align-items-center"],[1,"btn","btn-outline-success","mb-3",3,"disabled","click"],["formGroupName","addressForm",1,"row"],[1,"form-group","col-6"],["formControlName","firstName",3,"label"],["formControlName","lastName",3,"label"],["formControlName","street",3,"label"],["formControlName","city",3,"label"],["formControlName","state",3,"label"],["formControlName","zipcode",3,"label"],[1,"float-none","d-flex","justify-content-between","flex-column","flex-lg-row","mb-5"],["routerLink","/basket",1,"btn","btn-outline-primary"],[1,"fa","fa-angle-left"],["cdkStepperNext","",1,"btn","btn-primary"],[1,"fa","fa-angle-right"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"div",1),s.Qb(2,"h4"),s.yc(3,"Shipping address"),s.Pb(),s.Qb(4,"button",2),s.Xb("click",(function(){return t.saveUserAddress()})),s.yc(5," Save as default address "),s.Pb(),s.Pb(),s.Qb(6,"div",3),s.Qb(7,"div",4),s.Lb(8,"app-text-input",5),s.Pb(),s.Qb(9,"div",4),s.Lb(10,"app-text-input",6),s.Pb(),s.Qb(11,"div",4),s.Lb(12,"app-text-input",7),s.Pb(),s.Qb(13,"div",4),s.Lb(14,"app-text-input",8),s.Pb(),s.Qb(15,"div",4),s.Lb(16,"app-text-input",9),s.Pb(),s.Qb(17,"div",4),s.Lb(18,"app-text-input",10),s.Pb(),s.Pb(),s.Pb(),s.Qb(19,"div",11),s.Qb(20,"button",12),s.Lb(21,"i",13),s.yc(22," Back to basket "),s.Pb(),s.Qb(23,"button",14),s.yc(24," Go to delivery "),s.Lb(25,"i",15),s.Pb(),s.Pb()),2&e&&(s.fc("formGroup",t.checkoutForm),s.zb(4),s.fc("disabled",!t.checkoutForm.get("addressForm").valid||!t.checkoutForm.get("addressForm").dirty),s.zb(4),s.fc("label","First Name"),s.zb(2),s.fc("label","Last Name"),s.zb(2),s.fc("label","Street"),s.zb(2),s.fc("label","City"),s.zb(2),s.fc("label","State"),s.zb(2),s.fc("label","Zip Code"))},directives:[n.l,n.f,n.g,p.a,n.k,n.d,c.d,b.d],styles:[""]}),e})();var m=r("AytR"),h=r("lJxs"),v=r("tk/3");let k=(()=>{class e{constructor(e){this.http=e,this.baseUrl=m.a.apiUrl}createOrder(e){return this.http.post(this.baseUrl+"orders",e)}getDeliveryMethods(){return this.http.get(this.baseUrl+"orders/deliveryMethods").pipe(Object(h.a)(e=>e.sort((e,t)=>t.price-e.price)))}}return e.\u0275fac=function(t){return new(t||e)(s.Ub(v.b))},e.\u0275prov=s.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var g=r("cAP4");function y(e,t){if(1&e){const e=s.Rb();s.Qb(0,"div",9),s.Qb(1,"input",10),s.Xb("click",(function(){s.pc(e);const r=t.$implicit;return s.Zb().setShippingPrice(r)})),s.Pb(),s.Qb(2,"label",11),s.Qb(3,"strong"),s.yc(4),s.ac(5,"currency"),s.Pb(),s.Lb(6,"br"),s.Qb(7,"span",12),s.yc(8),s.Pb(),s.Pb(),s.Pb()}if(2&e){const e=t.$implicit;s.zb(1),s.gc("id",e.id),s.gc("value",e.id),s.zb(1),s.gc("for",e.id),s.zb(2),s.Bc("",e.shortName," - ",s.bc(5,6,e.price),""),s.zb(4),s.zc(e.description)}}let P=(()=>{class e{constructor(e,t){this.checkoutService=e,this.basketService=t}ngOnInit(){this.checkoutService.getDeliveryMethods().subscribe(e=>{this.deliveryMethods=e},e=>console.log(e))}setShippingPrice(e){this.basketService.setShippingPrice(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(k),s.Kb(g.a))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-checkout-delivery"]],inputs:{checkoutForm:"checkoutForm"},decls:12,vars:2,consts:[[1,"mt-4",3,"formGroup"],[1,"mb-3"],["formGroupName","deliveryForm",1,"row","ml-5"],["class","col-6 form-group",4,"ngFor","ngForOf"],[1,"float-none","d-flex","justify-content-between","flex-column","flex-lg-row","mb-5"],["cdkStepperPrevious","",1,"btn","btn-outline-primary"],[1,"fa","fa-angle-left"],["cdkStepperNext","",1,"btn","btn-primary"],[1,"fa","fa-angle-right"],[1,"col-6","form-group"],["type","radio","formControlName","deliveryMethod",1,"custom-control-input",3,"id","value","click"],[1,"custom-control-label",3,"for"],[1,"label-description"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"h4",1),s.yc(2,"Choose your delivery method"),s.Pb(),s.Qb(3,"div",2),s.wc(4,y,9,8,"div",3),s.Pb(),s.Pb(),s.Qb(5,"div",4),s.Qb(6,"button",5),s.Lb(7,"i",6),s.yc(8," Back to address "),s.Pb(),s.Qb(9,"button",7),s.yc(10," Go to review "),s.Lb(11,"i",8),s.Pb(),s.Pb()),2&e&&(s.fc("formGroup",t.checkoutForm),s.zb(4),s.fc("ngForOf",t.deliveryMethods))},directives:[n.l,n.f,n.g,o.l,b.e,b.d,n.o,n.a,n.k,n.d],pipes:[o.d],styles:[""]}),e})();var Q=r("GJcC");let F=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["app-checkout-review"]],decls:9,vars:1,consts:[[1,"mt-4"],[3,"isBasket"],[1,"float-none","d-flex","justify-content-between","flex-column","flex-lg-row","mb-5"],["cdkStepperPrevious","",1,"btn","btn-outline-primary"],[1,"fa","fa-angle-left"],["cdkStepperNext","",1,"btn","btn-primary"],[1,"fa","fa-angle-right"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Lb(1,"app-basket-summary",1),s.Pb(),s.Qb(2,"div",2),s.Qb(3,"button",3),s.Lb(4,"i",4),s.yc(5," Back to delivery "),s.Pb(),s.Qb(6,"button",5),s.yc(7," Go to payment "),s.Lb(8,"i",6),s.Pb(),s.Pb()),2&e&&(s.zb(1),s.fc("isBasket",!1))},directives:[Q.a,b.e,b.d],styles:[""]}),e})(),w=(()=>{class e{constructor(e,t,r,o){this.basketService=e,this.checkoutService=t,this.toastr=r,this.router=o}ngOnInit(){}submitOrder(){const e=this.basketService.getCurrentBasketValue(),t=this.getOrderToCreate(e);this.checkoutService.createOrder(t).subscribe(t=>{this.toastr.success("Order created successfully"),this.basketService.deleteLocalBasket(e.id),this.router.navigate(["checkout/success"],{state:t})},e=>{this.toastr.error(e.message),console.log(e)})}getOrderToCreate(e){return{basketId:e.id,deliveryMethodId:+this.checkoutForm.get("deliveryForm").get("deliveryMethod").value,shipToAddress:this.checkoutForm.get("addressForm").value}}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(g.a),s.Kb(k),s.Kb(d.b),s.Kb(c.c))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-checkout-payment"]],inputs:{checkoutForm:"checkoutForm"},decls:11,vars:0,consts:[[1,"ml-3",2,"font-size","larger"],[1,"float-none","d-flex","justify-content-between","flex-column","flex-lg-row","mb-5"],["cdkStepperPrevious","",1,"btn","btn-outline-primary"],[1,"fa","fa-angle-left"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-angle-right"]],template:function(e,t){1&e&&(s.Qb(0,"p",0),s.yc(1,"There should have been a form of payment, but... Need PCI DSS, strong customer Auth, Validating card, Stripe with SCA, need account in Stripe (stripe.com) and more..."),s.Pb(),s.Qb(2,"p",0),s.yc(3,'Just click "Submit order"!'),s.Pb(),s.Qb(4,"div",1),s.Qb(5,"button",2),s.Lb(6,"i",3),s.yc(7," Back to review "),s.Pb(),s.Qb(8,"button",4),s.Xb("click",(function(){return t.submitOrder()})),s.yc(9," Submit order "),s.Lb(10,"i",5),s.Pb(),s.Pb())},directives:[b.e],styles:[""]}),e})();var S=r("PoZw");function x(e,t){if(1&e&&(s.Qb(0,"button",5),s.yc(1," View your order"),s.Pb()),2&e){const e=s.Zb();s.hc("routerLink","/orders/",null==e.order?null:e.order.id,"")}}function C(e,t){1&e&&(s.Qb(0,"button",6),s.yc(1," View your orders"),s.Pb())}const z=[{path:"",component:(()=>{class e{constructor(e,t){this.fb=e,this.accountService=t}ngOnInit(){this.createCheckoutForm(),this.getAddressFormValues()}createCheckoutForm(){this.checkoutForm=this.fb.group({addressForm:this.fb.group({firstName:[null,n.q.required],lastName:[null,n.q.required],street:[null,n.q.required],city:[null,n.q.required],state:[null,n.q.required],zipcode:[null,n.q.required]}),deliveryForm:this.fb.group({deliveryMethod:[null,n.q.required]}),paymentForm:this.fb.group({nameOnCard:[null,n.q.required]})})}getAddressFormValues(){this.accountService.getUserAddress().subscribe(e=>{e&&this.checkoutForm.get("addressForm").patchValue(e)},e=>console.log(e))}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(n.b),s.Kb(i.a))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-checkout"]],decls:15,vars:10,consts:[[1,"container","mt-2"],[1,"row"],[1,"col-8"],[3,"linearModeSelected"],["appStepper",""],[3,"label","completed"],[3,"checkoutForm"],[3,"label"],[1,"col-4"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"div",1),s.Qb(2,"div",2),s.Qb(3,"app-stepper",3,4),s.Qb(5,"cdk-step",5),s.Lb(6,"app-checkout-address",6),s.Pb(),s.Qb(7,"cdk-step",5),s.Lb(8,"app-checkout-delivery",6),s.Pb(),s.Qb(9,"cdk-step",7),s.Lb(10,"app-checkout-review"),s.Pb(),s.Qb(11,"cdk-step",7),s.Lb(12,"app-checkout-payment",6),s.Pb(),s.Pb(),s.Pb(),s.Qb(13,"div",8),s.Lb(14,"app-order-totals"),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(3),s.fc("linearModeSelected",!1),s.zb(2),s.fc("label","Address")("completed",t.checkoutForm.get("addressForm").valid),s.zb(1),s.fc("checkoutForm",t.checkoutForm),s.zb(1),s.fc("label","Delivery")("completed",t.checkoutForm.get("deliveryForm").valid),s.zb(1),s.fc("checkoutForm",t.checkoutForm),s.zb(1),s.fc("label","Review"),s.zb(2),s.fc("label","Payment"),s.zb(1),s.fc("checkoutForm",t.checkoutForm))},directives:[l,b.a,f,P,F,w,S.a],styles:[""]}),e})()},{path:"success",component:(()=>{class e{constructor(e){this.router=e;const t=this.router.getCurrentNavigation(),r=t&&t.extras&&t.extras.state;r&&(this.order=r)}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(c.c))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-checkout-success"]],decls:9,vars:2,consts:[[1,"container","mt-5"],[1,"fa","fa-check-circle","fa-5x",2,"color","green"],[1,"mb-4"],["class","btn btn-outline-success",3,"routerLink",4,"ngIf"],["routerLink","/orders","class","btn btn-outline-success",4,"ngIf"],[1,"btn","btn-outline-success",3,"routerLink"],["routerLink","/orders",1,"btn","btn-outline-success"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"div"),s.Lb(2,"i",1),s.Pb(),s.Qb(3,"h2"),s.yc(4,"Thank you. Your order is confirmed"),s.Pb(),s.Qb(5,"p",2),s.yc(6,"Your order has not shipped yet, but this is to be expected as we are not a real store!"),s.Pb(),s.wc(7,x,2,1,"button",3),s.wc(8,C,2,0,"button",4),s.Pb()),2&e&&(s.zb(7),s.fc("ngIf",t.order),s.zb(1),s.fc("ngIf",!t.order))},directives:[o.m,c.d],styles:[""]}),e})()}];let L=(()=>{class e{}return e.\u0275mod=s.Ib({type:e}),e.\u0275inj=s.Hb({factory:function(t){return new(t||e)},imports:[[c.g.forChild(z)],c.g]}),e})();var O=r("PCNd");let N=(()=>{class e{}return e.\u0275mod=s.Ib({type:e}),e.\u0275inj=s.Hb({factory:function(t){return new(t||e)},imports:[[o.c,L,O.a]]}),e})()}}]);